

/*
Source:
https://github.com/CSSEGISandData/COVID-19/blob/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv
*/

--> DROP EXTERNAL TABLE testCovid 

IF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseDelimitedTextFormat') 
	CREATE EXTERNAL FILE FORMAT [SynapseDelimitedTextFormat] 
	WITH ( FORMAT_TYPE = DELIMITEDTEXT ,
	       FORMAT_OPTIONS (
			 FIELD_TERMINATOR = ',',
			 USE_TYPE_DEFAULT = FALSE
			))
GO

IF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'cssecovid19timeseries_anbenedadls_dfs_core_windows_net') 
	CREATE EXTERNAL DATA SOURCE [cssecovid19timeseries_anbenedadls_dfs_core_windows_net] 
	WITH (
		LOCATION = 'abfss://cssecovid19timeseries@anbenedadls.dfs.core.windows.net' 
	)
GO



CREATE EXTERNAL TABLE testCovid (
	[UID] nvarchar(4000),
	[iso2] nvarchar(4000),
	[iso3] nvarchar(4000),
	[code3] nvarchar(4000),
	[FIPS] nvarchar(4000),
	[Admin2] nvarchar(4000),
	[Province_State] nvarchar(4000),
	[Country_Region] nvarchar(4000),
	[Lat] nvarchar(4000),
	[Long_] nvarchar(4000),
	[Combined_Key] nvarchar(4000),
	[1/22/20] nvarchar(4000),	[1/23/20] nvarchar(4000),
	[1/24/20] nvarchar(4000),	[1/25/20] nvarchar(4000),
	[1/26/20] nvarchar(4000),	[1/27/20] nvarchar(4000),
	[1/28/20] nvarchar(4000),	[1/29/20] nvarchar(4000),
	[1/30/20] nvarchar(4000),	[1/31/20] nvarchar(4000),
	[2/1/20] nvarchar(4000),	[2/2/20] nvarchar(4000),
	[2/3/20] nvarchar(4000),	[2/4/20] nvarchar(4000),
	[2/5/20] nvarchar(4000),	[2/6/20] nvarchar(4000),
	[2/7/20] nvarchar(4000),	[2/8/20] nvarchar(4000),
	[2/9/20] nvarchar(4000),	[2/10/20] nvarchar(4000),
	[2/11/20] nvarchar(4000),	[2/12/20] nvarchar(4000),
	[2/13/20] nvarchar(4000),	[2/14/20] nvarchar(4000),
	[2/15/20] nvarchar(4000),	[2/16/20] nvarchar(4000),
	[2/17/20] nvarchar(4000),	[2/18/20] nvarchar(4000),
	[2/19/20] nvarchar(4000),	[2/20/20] nvarchar(4000),
	[2/21/20] nvarchar(4000),	[2/22/20] nvarchar(4000),
	[2/23/20] nvarchar(4000),	[2/24/20] nvarchar(4000),
	[2/25/20] nvarchar(4000),	[2/26/20] nvarchar(4000),
	[2/27/20] nvarchar(4000),	[2/28/20] nvarchar(4000),
	[2/29/20] nvarchar(4000),	[3/1/20] nvarchar(4000),
	[3/2/20] nvarchar(4000),	[3/3/20] nvarchar(4000),
	[3/4/20] nvarchar(4000),	[3/5/20] nvarchar(4000),
	[3/6/20] nvarchar(4000),	[3/7/20] nvarchar(4000),
	[3/8/20] nvarchar(4000),	[3/9/20] nvarchar(4000),
	[3/10/20] nvarchar(4000),	[3/11/20] nvarchar(4000),
	[3/12/20] nvarchar(4000),	[3/13/20] nvarchar(4000),
	[3/14/20] nvarchar(4000),	[3/15/20] nvarchar(4000),
	[3/16/20] nvarchar(4000),	[3/17/20] nvarchar(4000),
	[3/18/20] nvarchar(4000),	[3/19/20] nvarchar(4000),
	[3/20/20] nvarchar(4000),	[3/21/20] nvarchar(4000),
	[3/22/20] nvarchar(4000),	[3/23/20] nvarchar(4000),
	[3/24/20] nvarchar(4000),	[3/25/20] nvarchar(4000),
	[3/26/20] nvarchar(4000),	[3/27/20] nvarchar(4000),
	[3/28/20] nvarchar(4000),	[3/29/20] nvarchar(4000),
	[3/30/20] nvarchar(4000),	[3/31/20] nvarchar(4000),
	[4/1/20] nvarchar(4000),	[4/2/20] nvarchar(4000),
	[4/3/20] nvarchar(4000),	[4/4/20] nvarchar(4000),
	[4/5/20] nvarchar(4000),	[4/6/20] nvarchar(4000),
	[4/7/20] nvarchar(4000),	[4/8/20] nvarchar(4000),
	[4/9/20] nvarchar(4000),	[4/10/20] nvarchar(4000),
	[4/11/20] nvarchar(4000),	[4/12/20] nvarchar(4000),
	[4/13/20] nvarchar(4000),	[4/14/20] nvarchar(4000),
	[4/15/20] nvarchar(4000),	[4/16/20] nvarchar(4000),
	[4/17/20] nvarchar(4000),	[4/18/20] nvarchar(4000),
	[4/19/20] nvarchar(4000),	[4/20/20] nvarchar(4000),
	[4/21/20] nvarchar(4000),	[4/22/20] nvarchar(4000),
	[4/23/20] nvarchar(4000),	[4/24/20] nvarchar(4000),
	[4/25/20] nvarchar(4000),	[4/26/20] nvarchar(4000),
	[4/27/20] nvarchar(4000),	[4/28/20] nvarchar(4000),
	[4/29/20] nvarchar(4000),	[4/30/20] nvarchar(4000),
	[5/1/20] nvarchar(4000),	[5/2/20] nvarchar(4000),
	[5/3/20] nvarchar(4000),	[5/4/20] nvarchar(4000),
	[5/5/20] nvarchar(4000),	[5/6/20] nvarchar(4000),
	[5/7/20] nvarchar(4000),	[5/8/20] nvarchar(4000),
	[5/9/20] nvarchar(4000),	[5/10/20] nvarchar(4000),
	[5/11/20] nvarchar(4000),	[5/12/20] nvarchar(4000),
	[5/13/20] nvarchar(4000),	[5/14/20] nvarchar(4000),
	[5/15/20] nvarchar(4000),	[5/16/20] nvarchar(4000),
	[5/17/20] nvarchar(4000),	[5/18/20] nvarchar(4000),
	[5/19/20] nvarchar(4000),	[5/20/20] nvarchar(4000),
	[5/21/20] nvarchar(4000),	[5/22/20] nvarchar(4000),
	[5/23/20] nvarchar(4000),	[5/24/20] nvarchar(4000),
	[5/25/20] nvarchar(4000),	[5/26/20] nvarchar(4000),
	[5/27/20] nvarchar(4000),	[5/28/20] nvarchar(4000),
	[5/29/20] nvarchar(4000),	[5/30/20] nvarchar(4000),
	[5/31/20] nvarchar(4000),	[6/1/20] nvarchar(4000),
	[6/2/20] nvarchar(4000),	[6/3/20] nvarchar(4000),
	[6/4/20] nvarchar(4000),	[6/5/20] nvarchar(4000),
	[6/6/20] nvarchar(4000),	[6/7/20] nvarchar(4000),
	[6/8/20] nvarchar(4000),	[6/9/20] nvarchar(4000),
	[6/10/20] nvarchar(4000),	[6/11/20] nvarchar(4000),
	[6/12/20] nvarchar(4000),	[6/13/20] nvarchar(4000),
	[6/14/20] nvarchar(4000),	[6/15/20] nvarchar(4000),
	[6/16/20] nvarchar(4000),	[6/17/20] nvarchar(4000),
	[6/18/20] nvarchar(4000),	[6/19/20] nvarchar(4000),
	[6/20/20] nvarchar(4000),	[6/21/20] nvarchar(4000),
	[6/22/20] nvarchar(4000),	[6/23/20] nvarchar(4000),
	[6/24/20] nvarchar(4000),	[6/25/20] nvarchar(4000),
	[6/26/20] nvarchar(4000),	[6/27/20] nvarchar(4000),
	[6/28/20] nvarchar(4000),	[6/29/20] nvarchar(4000),
	[6/30/20] nvarchar(4000),	[7/1/20] nvarchar(4000),
	[7/2/20] nvarchar(4000),	[7/3/20] nvarchar(4000),
	[7/4/20] nvarchar(4000),	[7/5/20] nvarchar(4000),
	[7/6/20] nvarchar(4000),	[7/7/20] nvarchar(4000),
	[7/8/20] nvarchar(4000),	[7/9/20] nvarchar(4000),
	[7/10/20] nvarchar(4000),	[7/11/20] nvarchar(4000),
	[7/12/20] nvarchar(4000),	[7/13/20] nvarchar(4000),
	[7/14/20] nvarchar(4000),	[7/15/20] nvarchar(4000),
	[7/16/20] nvarchar(4000),	[7/17/20] nvarchar(4000),
	[7/18/20] nvarchar(4000),	[7/19/20] nvarchar(4000),
	[7/20/20] nvarchar(4000),	[7/21/20] nvarchar(4000),
	[7/22/20] nvarchar(4000),	[7/23/20] nvarchar(4000),
	[7/24/20] nvarchar(4000),	[7/25/20] nvarchar(4000),
	[7/26/20] nvarchar(4000),	[7/27/20] nvarchar(4000),
	[7/28/20] nvarchar(4000),	[7/29/20] nvarchar(4000),
	[7/30/20] nvarchar(4000),	[7/31/20] nvarchar(4000),
	[8/1/20] nvarchar(4000),	[8/2/20] nvarchar(4000),
	[8/3/20] nvarchar(4000),	[8/4/20] nvarchar(4000),
	[8/5/20] nvarchar(4000),	[8/6/20] nvarchar(4000),
	[8/7/20] nvarchar(4000),	[8/8/20] nvarchar(4000),
	[8/9/20] nvarchar(4000),	[8/10/20] nvarchar(4000),
	[8/11/20] nvarchar(4000),	[8/12/20] nvarchar(4000),
	[8/13/20] nvarchar(4000),	[8/14/20] nvarchar(4000),
	[8/15/20] nvarchar(4000),	[8/16/20] nvarchar(4000),
	[8/17/20] nvarchar(4000),	[8/18/20] nvarchar(4000),
	[8/19/20] nvarchar(4000),	[8/20/20] nvarchar(4000),
	[8/21/20] nvarchar(4000),	[8/22/20] nvarchar(4000),
	[8/23/20] nvarchar(4000),	[8/24/20] nvarchar(4000),
	[8/25/20] nvarchar(4000),	[8/26/20] nvarchar(4000),
	[8/27/20] nvarchar(4000),	[8/28/20] nvarchar(4000),
	[8/29/20] nvarchar(4000),	[8/30/20] nvarchar(4000),
	[8/31/20] nvarchar(4000),	[9/1/20] nvarchar(4000),
	[9/2/20] nvarchar(4000),	[9/3/20] nvarchar(4000),
	[9/4/20] nvarchar(4000),	[9/5/20] nvarchar(4000),
	[9/6/20] nvarchar(4000),	[9/7/20] nvarchar(4000),
	[9/8/20] nvarchar(4000),	[9/9/20] nvarchar(4000),
	[9/10/20] nvarchar(4000),	[9/11/20] nvarchar(4000),
	[9/12/20] nvarchar(4000),	[9/13/20] nvarchar(4000),
	[9/14/20] nvarchar(4000),	[9/15/20] nvarchar(4000),
	[9/16/20] nvarchar(4000),	[9/17/20] nvarchar(4000),
	[9/18/20] nvarchar(4000),	[9/19/20] nvarchar(4000),
	[9/20/20] nvarchar(4000),	[9/21/20] nvarchar(4000),
	[9/22/20] nvarchar(4000),	[9/23/20] nvarchar(4000),
	[9/24/20] nvarchar(4000),	[9/25/20] nvarchar(4000),
	[9/26/20] nvarchar(4000),	[9/27/20] nvarchar(4000),
	[9/28/20] nvarchar(4000),	[9/29/20] nvarchar(4000),
	[9/30/20] nvarchar(4000),	[10/1/20] nvarchar(4000),
	[10/2/20] nvarchar(4000),	[10/3/20] nvarchar(4000),
	[10/4/20] nvarchar(4000),	[10/5/20] nvarchar(4000),
	[10/6/20] nvarchar(4000),	[10/7/20] nvarchar(4000),
	[10/8/20] nvarchar(4000),	[10/9/20] nvarchar(4000),
	[10/10/20] nvarchar(4000),	[10/11/20] nvarchar(4000),
	[10/12/20] nvarchar(4000),	[10/13/20] nvarchar(4000),
	[10/14/20] nvarchar(4000),	[10/15/20] nvarchar(4000),
	[10/16/20] nvarchar(4000),	[10/17/20] nvarchar(4000),
	[10/18/20] nvarchar(4000),	[10/19/20] nvarchar(4000),
	[10/20/20] nvarchar(4000),	[10/21/20] nvarchar(4000),
	[10/22/20] nvarchar(4000),	[10/23/20] nvarchar(4000),
	[10/24/20] nvarchar(4000),	[10/25/20] nvarchar(4000),
	[10/26/20] nvarchar(4000),	[10/27/20] nvarchar(4000),
	[10/28/20] nvarchar(4000),	[10/29/20] nvarchar(4000),
	[10/30/20] nvarchar(4000),	[10/31/20] nvarchar(4000),
	[11/1/20] nvarchar(4000),	[11/2/20] nvarchar(4000),
	[11/3/20] nvarchar(4000),	[11/4/20] nvarchar(4000),
	[11/5/20] nvarchar(4000),	[11/6/20] nvarchar(4000),
	[11/7/20] nvarchar(4000),	[11/8/20] nvarchar(4000),
	[11/9/20] nvarchar(4000),	[11/10/20] nvarchar(4000),
	[11/11/20] nvarchar(4000),	[11/12/20] nvarchar(4000),
	[11/13/20] nvarchar(4000),	[11/14/20] nvarchar(4000),
	[11/15/20] nvarchar(4000),	[11/16/20] nvarchar(4000),
	[11/17/20] nvarchar(4000),	[11/18/20] nvarchar(4000),
	[11/19/20] nvarchar(4000),	[11/20/20] nvarchar(4000),
	[11/21/20] nvarchar(4000),	[11/22/20] nvarchar(4000),
	[11/23/20] nvarchar(4000),	[11/24/20] nvarchar(4000),
	[11/25/20] nvarchar(4000),	[11/26/20] nvarchar(4000),
	[11/27/20] nvarchar(4000),	[11/28/20] nvarchar(4000),
	[11/29/20] nvarchar(4000),	[11/30/20] nvarchar(4000),
	[12/1/20] nvarchar(4000),	[12/2/20] nvarchar(4000),
	[12/3/20] nvarchar(4000),	[12/4/20] nvarchar(4000),
	[12/5/20] nvarchar(4000),	[12/6/20] nvarchar(4000),
	[12/7/20] nvarchar(4000),	[12/8/20] nvarchar(4000),
	[12/9/20] nvarchar(4000),	[12/10/20] nvarchar(4000),
	[12/11/20] nvarchar(4000),	[12/12/20] nvarchar(4000),
	[12/13/20] nvarchar(4000),	[12/14/20] nvarchar(4000),
	[12/15/20] nvarchar(4000),	[12/16/20] nvarchar(4000),
	[12/17/20] nvarchar(4000),	[12/18/20] nvarchar(4000),
	[12/19/20] nvarchar(4000),	[12/20/20] nvarchar(4000),
	[12/21/20] nvarchar(4000),	[12/22/20] nvarchar(4000),
	[12/23/20] nvarchar(4000),	[12/24/20] nvarchar(4000),
	[12/25/20] nvarchar(4000),	[12/26/20] nvarchar(4000),
	[12/27/20] nvarchar(4000),	[12/28/20] nvarchar(4000),
	[12/29/20] nvarchar(4000),	[12/30/20] nvarchar(4000),
	[12/31/20] nvarchar(4000),	[1/1/21] nvarchar(4000),
	[1/2/21] nvarchar(4000),	[1/3/21] nvarchar(4000),
	[1/4/21] nvarchar(4000),	[1/5/21] nvarchar(4000),
	[1/6/21] nvarchar(4000),	[1/7/21] nvarchar(4000),
	[1/8/21] nvarchar(4000),	[1/9/21] nvarchar(4000),
	[1/10/21] nvarchar(4000),	[1/11/21] nvarchar(4000),
	[1/12/21] nvarchar(4000),	[1/13/21] nvarchar(4000),
	[1/14/21] nvarchar(4000),	[1/15/21] nvarchar(4000),
	[1/16/21] nvarchar(4000),	[1/17/21] nvarchar(4000),
	[1/18/21] nvarchar(4000),	[1/19/21] nvarchar(4000),
	[1/20/21] nvarchar(4000),	[1/21/21] nvarchar(4000),
	[1/22/21] nvarchar(4000),	[1/23/21] nvarchar(4000),
	[1/24/21] nvarchar(4000),	[1/25/21] nvarchar(4000),
	[1/26/21] nvarchar(4000),	[1/27/21] nvarchar(4000),
	[1/28/21] nvarchar(4000),	[1/29/21] nvarchar(4000),
	[1/30/21] nvarchar(4000),	[1/31/21] nvarchar(4000),
	[2/1/21] nvarchar(4000),	[2/2/21] nvarchar(4000),
	[2/3/21] nvarchar(4000),	[2/4/21] nvarchar(4000),
	[2/5/21] nvarchar(4000),	[2/6/21] nvarchar(4000),
	[2/7/21] nvarchar(4000),	[2/8/21] nvarchar(4000),
	[2/9/21] nvarchar(4000),	[2/10/21] nvarchar(4000),
	[2/11/21] nvarchar(4000),	[2/12/21] nvarchar(4000),
	[2/13/21] nvarchar(4000),	[2/14/21] nvarchar(4000),
	[2/15/21] nvarchar(4000),	[2/16/21] nvarchar(4000),
	[2/17/21] nvarchar(4000),	[2/18/21] nvarchar(4000),
	[2/19/21] nvarchar(4000),	[2/20/21] nvarchar(4000),
	[2/21/21] nvarchar(4000),	[2/22/21] nvarchar(4000),
	[2/23/21] nvarchar(4000),	[2/24/21] nvarchar(4000),
	[2/25/21] nvarchar(4000),	[2/26/21] nvarchar(4000),
	[2/27/21] nvarchar(4000),	[2/28/21] nvarchar(4000),
	[3/1/21] nvarchar(4000),	[3/2/21] nvarchar(4000),
	[3/3/21] nvarchar(4000),	[3/4/21] nvarchar(4000),
	[3/5/21] nvarchar(4000),	[3/6/21] nvarchar(4000),
	[3/7/21] nvarchar(4000),	[3/8/21] nvarchar(4000),
	[3/9/21] nvarchar(4000),	[3/10/21] nvarchar(4000),
	[3/11/21] nvarchar(4000),	[3/12/21] nvarchar(4000),
	[3/13/21] nvarchar(4000),	[3/14/21] nvarchar(4000),
	[3/15/21] nvarchar(4000),	[3/16/21] nvarchar(4000),
	[3/17/21] nvarchar(4000),	[3/18/21] nvarchar(4000),
	[3/19/21] nvarchar(4000),	[3/20/21] nvarchar(4000),
	[3/21/21] nvarchar(4000),	[3/22/21] nvarchar(4000),
	[3/23/21] nvarchar(4000),	[3/24/21] nvarchar(4000),
	[3/25/21] nvarchar(4000),	[3/26/21] nvarchar(4000),
	[3/27/21] nvarchar(4000),	[3/28/21] nvarchar(4000),
	[3/29/21] nvarchar(4000),	[3/30/21] nvarchar(4000),
	[3/31/21] nvarchar(4000),	[4/1/21] nvarchar(4000),
	[4/2/21] nvarchar(4000),	[4/3/21] nvarchar(4000),
	[4/4/21] nvarchar(4000),	[4/5/21] nvarchar(4000),
	[4/6/21] nvarchar(4000),	[4/7/21] nvarchar(4000),
	[4/8/21] nvarchar(4000),	[4/9/21] nvarchar(4000),
	[4/10/21] nvarchar(4000),	[4/11/21] nvarchar(4000),
	[4/12/21] nvarchar(4000),	[4/13/21] nvarchar(4000),
	[4/14/21] nvarchar(4000),	[4/15/21] nvarchar(4000),
	[4/16/21] nvarchar(4000),	[4/17/21] nvarchar(4000),
	[4/18/21] nvarchar(4000),	[4/19/21] nvarchar(4000),
	[4/20/21] nvarchar(4000),	[4/21/21] nvarchar(4000),
	[4/22/21] nvarchar(4000),	[4/23/21] nvarchar(4000),
	[4/24/21] nvarchar(4000),	[4/25/21] nvarchar(4000),
	[4/26/21] nvarchar(4000),	[4/27/21] nvarchar(4000),
	[4/28/21] nvarchar(4000),	[4/29/21] nvarchar(4000),
	[4/30/21] nvarchar(4000),	[5/1/21] nvarchar(4000),
	[5/2/21] nvarchar(4000),	[5/3/21] nvarchar(4000),
	[5/4/21] nvarchar(4000),	[5/5/21] nvarchar(4000),
	[5/6/21] nvarchar(4000),	[5/7/21] nvarchar(4000),
	[5/8/21] nvarchar(4000),	[5/9/21] nvarchar(4000),
	[5/10/21] nvarchar(4000),	[5/11/21] nvarchar(4000),
	[5/12/21] nvarchar(4000),	[5/13/21] nvarchar(4000),
	[5/14/21] nvarchar(4000),	[5/15/21] nvarchar(4000),
	[5/16/21] nvarchar(4000),	[5/17/21] nvarchar(4000),
	[5/18/21] nvarchar(4000),	[5/19/21] nvarchar(4000),
	[5/20/21] nvarchar(4000),	[5/21/21] nvarchar(4000),
	[5/22/21] nvarchar(4000),	[5/23/21] nvarchar(4000),
	[5/24/21] nvarchar(4000),	[5/25/21] nvarchar(4000),
	[5/26/21] nvarchar(4000),	[5/27/21] nvarchar(4000),
	[5/28/21] nvarchar(4000),	[5/29/21] nvarchar(4000),
	[5/30/21] nvarchar(4000),	[5/31/21] nvarchar(4000),
	[6/1/21] nvarchar(4000),	[6/2/21] nvarchar(4000),
	[6/3/21] nvarchar(4000),	[6/4/21] nvarchar(4000),
	[6/5/21] nvarchar(4000),	[6/6/21] nvarchar(4000),
	[6/7/21] nvarchar(4000),	[6/8/21] nvarchar(4000),
	[6/9/21] nvarchar(4000),	[6/10/21] nvarchar(4000),
	[6/11/21] nvarchar(4000),	[6/12/21] nvarchar(4000),
	[6/13/21] nvarchar(4000),	[6/14/21] nvarchar(4000),
	[6/15/21] nvarchar(4000),	[6/16/21] nvarchar(4000),
	[6/17/21] nvarchar(4000),	[6/18/21] nvarchar(4000),
	[6/19/21] nvarchar(4000),	[6/20/21] nvarchar(4000),
	[6/21/21] nvarchar(4000),	[6/22/21] nvarchar(4000),
	[6/23/21] nvarchar(4000),	[6/24/21] nvarchar(4000),
	[6/25/21] nvarchar(4000),	[6/26/21] nvarchar(4000),
	[6/27/21] nvarchar(4000),	[6/28/21] nvarchar(4000),
	[6/29/21] nvarchar(4000),	[6/30/21] nvarchar(4000),
	[7/1/21] nvarchar(4000),	[7/2/21] nvarchar(4000),
	[7/3/21] nvarchar(4000),	[7/4/21] nvarchar(4000),
	[7/5/21] nvarchar(4000),	[7/6/21] nvarchar(4000),
	[7/7/21] nvarchar(4000),	[7/8/21] nvarchar(4000),
	[7/9/21] nvarchar(4000),	[7/10/21] nvarchar(4000),
	[7/11/21] nvarchar(4000),	[7/12/21] nvarchar(4000),
	[7/13/21] nvarchar(4000),	[7/14/21] nvarchar(4000),
	[7/15/21] nvarchar(4000),	[7/16/21] nvarchar(4000),
	[7/17/21] nvarchar(4000),	[7/18/21] nvarchar(4000),
	[7/19/21] nvarchar(4000),	[7/20/21] nvarchar(4000),
	[7/21/21] nvarchar(4000),	[7/22/21] nvarchar(4000),
	[7/23/21] nvarchar(4000),	[7/24/21] nvarchar(4000),
	[7/25/21] nvarchar(4000),	[7/26/21] nvarchar(4000),
	[7/27/21] nvarchar(4000),	[7/28/21] nvarchar(4000),
	[7/29/21] nvarchar(4000),	[7/30/21] nvarchar(4000),
	[7/31/21] nvarchar(4000),	[8/1/21] nvarchar(4000),
	[8/2/21] nvarchar(4000),	[8/3/21] nvarchar(4000),
	[8/4/21] nvarchar(4000),	[8/5/21] nvarchar(4000),
	[8/6/21] nvarchar(4000),	[8/7/21] nvarchar(4000),
	[8/8/21] nvarchar(4000),	[8/9/21] nvarchar(4000),
	[8/10/21] nvarchar(4000),	[8/11/21] nvarchar(4000),
	[8/12/21] nvarchar(4000),	[8/13/21] nvarchar(4000),
	[8/14/21] nvarchar(4000),	[8/15/21] nvarchar(4000),
	[8/16/21] nvarchar(4000),	[8/17/21] nvarchar(4000),
	[8/18/21] nvarchar(4000),	[8/19/21] nvarchar(4000),
	[8/20/21] nvarchar(4000),	[8/21/21] nvarchar(4000),
	[8/22/21] nvarchar(4000),	[8/23/21] nvarchar(4000),
	[8/24/21] nvarchar(4000),	[8/25/21] nvarchar(4000),
	[8/26/21] nvarchar(4000),	[8/27/21] nvarchar(4000),
	[8/28/21] nvarchar(4000),	[8/29/21] nvarchar(4000),
	[8/30/21] nvarchar(4000),	[8/31/21] nvarchar(4000),
	[9/1/21] nvarchar(4000),	[9/2/21] nvarchar(4000),
	[9/3/21] nvarchar(4000),	[9/4/21] nvarchar(4000),
	[9/5/21] nvarchar(4000),	[9/6/21] nvarchar(4000),
	[9/7/21] nvarchar(4000),	[9/8/21] nvarchar(4000),
	[9/9/21] nvarchar(4000),	[9/10/21] nvarchar(4000),
	[9/11/21] nvarchar(4000),	[9/12/21] nvarchar(4000),
	[9/13/21] nvarchar(4000),	[9/14/21] nvarchar(4000),
	[9/15/21] nvarchar(4000),	[9/16/21] nvarchar(4000),
	[9/17/21] nvarchar(4000),	[9/18/21] nvarchar(4000),
	[9/19/21] nvarchar(4000),	[9/20/21] nvarchar(4000),
	[9/21/21] nvarchar(4000),	[9/22/21] nvarchar(4000),
	[9/23/21] nvarchar(4000),	[9/24/21] nvarchar(4000),
	[9/25/21] nvarchar(4000),	[9/26/21] nvarchar(4000),
	[9/27/21] nvarchar(4000),	[9/28/21] nvarchar(4000),
	[9/29/21] nvarchar(4000),	[9/30/21] nvarchar(4000),
	[10/1/21] nvarchar(4000),	[10/2/21] nvarchar(4000),
	[10/3/21] nvarchar(4000),	[10/4/21] nvarchar(4000),
	[10/5/21] nvarchar(4000),	[10/6/21] nvarchar(4000),
	[10/7/21] nvarchar(4000),	[10/8/21] nvarchar(4000),
	[10/9/21] nvarchar(4000),	[10/10/21] nvarchar(4000),
	[10/11/21] nvarchar(4000),	[10/12/21] nvarchar(4000),
	[10/13/21] nvarchar(4000),	[10/14/21] nvarchar(4000),
	[10/15/21] nvarchar(4000),	[10/16/21] nvarchar(4000),
	[10/17/21] nvarchar(4000),	[10/18/21] nvarchar(4000),
	[10/19/21] nvarchar(4000),	[10/20/21] nvarchar(4000),
	[10/21/21] nvarchar(4000),	[10/22/21] nvarchar(4000),
	[10/23/21] nvarchar(4000),	[10/24/21] nvarchar(4000),
	[10/25/21] nvarchar(4000),	[10/26/21] nvarchar(4000),
	[10/27/21] nvarchar(4000),	[10/28/21] nvarchar(4000),
	[10/29/21] nvarchar(4000),	[10/30/21] nvarchar(4000),
	[10/31/21] nvarchar(4000),	[11/1/21] nvarchar(4000),
	[11/2/21] nvarchar(4000),	[11/3/21] nvarchar(4000),
	[11/4/21] nvarchar(4000),	[11/5/21] nvarchar(4000),
	[11/6/21] nvarchar(4000),	[11/7/21] nvarchar(4000),
	[11/8/21] nvarchar(4000),	[11/9/21] nvarchar(4000),
	[11/10/21] nvarchar(4000),	[11/11/21] nvarchar(4000),
	[11/12/21] nvarchar(4000),	[11/13/21] nvarchar(4000),
	[11/14/21] nvarchar(4000),	[11/15/21] nvarchar(4000),
	[11/16/21] nvarchar(4000),	[11/17/21] nvarchar(4000),
	[11/18/21] nvarchar(4000),	[11/19/21] nvarchar(4000),
	[11/20/21] nvarchar(4000),	[11/21/21] nvarchar(4000),
	[11/22/21] nvarchar(4000),	[11/23/21] nvarchar(4000),
	[11/24/21] nvarchar(4000),	[11/25/21] nvarchar(4000),
	[11/26/21] nvarchar(4000),	[11/27/21] nvarchar(4000),
	[11/28/21] nvarchar(4000),	[11/29/21] nvarchar(4000),
	[11/30/21] nvarchar(4000),	[12/1/21] nvarchar(4000),
	[12/2/21] nvarchar(4000),	[12/3/21] nvarchar(4000),
	[12/4/21] nvarchar(4000),	[12/5/21] nvarchar(4000),
	[12/6/21] nvarchar(4000),	[12/7/21] nvarchar(4000),
	[12/8/21] nvarchar(4000),	[12/9/21] nvarchar(4000),
	[12/10/21] nvarchar(4000),	[12/11/21] nvarchar(4000),
	[12/12/21] nvarchar(4000),	[12/13/21] nvarchar(4000),
	[12/14/21] nvarchar(4000),	[12/15/21] nvarchar(4000),
	[12/16/21] nvarchar(4000),	[12/17/21] nvarchar(4000),
	[12/18/21] nvarchar(4000),	[12/19/21] nvarchar(4000),
	[12/20/21] nvarchar(4000),	[12/21/21] nvarchar(4000),
	[12/22/21] nvarchar(4000),	[12/23/21] nvarchar(4000),
	[12/24/21] nvarchar(4000),	[12/25/21] nvarchar(4000),
	[12/26/21] nvarchar(4000),	[12/27/21] nvarchar(4000),
	[12/28/21] nvarchar(4000),	[12/29/21] nvarchar(4000),
	[12/30/21] nvarchar(4000),	[12/31/21] nvarchar(4000),
	[1/1/22] nvarchar(4000),	[1/2/22] nvarchar(4000),
	[1/3/22] nvarchar(4000),	[1/4/22] nvarchar(4000),
	[1/5/22] nvarchar(4000),	[1/6/22] nvarchar(4000),
	[1/7/22] nvarchar(4000),	[1/8/22] nvarchar(4000),
	[1/9/22] nvarchar(4000),	[1/10/22] nvarchar(4000),
	[1/11/22] nvarchar(4000),	[1/12/22] nvarchar(4000),
	[1/13/22] nvarchar(4000),	[1/14/22] nvarchar(4000),
	[1/15/22] nvarchar(4000),	[1/16/22] nvarchar(4000),
	[1/17/22] nvarchar(4000),	[1/18/22] nvarchar(4000),
	[1/19/22] nvarchar(4000),	[1/20/22] nvarchar(4000),
	[1/21/22] nvarchar(4000),	[1/22/22] nvarchar(4000),
	[1/23/22] nvarchar(4000),	[1/24/22] nvarchar(4000),
	[1/25/22] nvarchar(4000),	[1/26/22] nvarchar(4000),
	[1/27/22] nvarchar(4000),	[1/28/22] nvarchar(4000),
	[1/29/22] nvarchar(4000),	[1/30/22] nvarchar(4000),
	[1/31/22] nvarchar(4000),	[2/1/22] nvarchar(4000),
	[2/2/22] nvarchar(4000),	[2/3/22] nvarchar(4000),
	[2/4/22] nvarchar(4000),	[2/5/22] nvarchar(4000),
	[2/6/22] nvarchar(4000),	[2/7/22] nvarchar(4000),
	[2/8/22] nvarchar(4000),	[2/9/22] nvarchar(4000),
	[2/10/22] nvarchar(4000),	[2/11/22] nvarchar(4000),
	[2/12/22] nvarchar(4000),	[2/13/22] nvarchar(4000),
	[2/14/22] nvarchar(4000),	[2/15/22] nvarchar(4000),
	[2/16/22] nvarchar(4000),	[2/17/22] nvarchar(4000),
	[2/18/22] nvarchar(4000),	[2/19/22] nvarchar(4000),
	[2/20/22] nvarchar(4000),	[2/21/22] nvarchar(4000),
	[2/22/22] nvarchar(4000),	[2/23/22] nvarchar(4000),
	[2/24/22] nvarchar(4000),	[2/25/22] nvarchar(4000),
	[2/26/22] nvarchar(4000),	[2/27/22] nvarchar(4000),
	[2/28/22] nvarchar(4000),	[3/1/22] nvarchar(4000),
	[3/2/22] nvarchar(4000),	[3/3/22] nvarchar(4000),
	[3/4/22] nvarchar(4000),	[3/5/22] nvarchar(4000),
	[3/6/22] nvarchar(4000),	[3/7/22] nvarchar(4000),
	[3/8/22] nvarchar(4000),	[3/9/22] nvarchar(4000),
	[3/10/22] nvarchar(4000),	[3/11/22] nvarchar(4000),
	[3/12/22] nvarchar(4000),	[3/13/22] nvarchar(4000),
	[3/14/22] nvarchar(4000),	[3/15/22] nvarchar(4000),
	[3/16/22] nvarchar(4000),	[3/17/22] nvarchar(4000),
	[3/18/22] nvarchar(4000),	[3/19/22] nvarchar(4000),
	[3/20/22] nvarchar(4000),	[3/21/22] nvarchar(4000),
	[3/22/22] nvarchar(4000),	[3/23/22] nvarchar(4000),
	[3/24/22] nvarchar(4000),	[3/25/22] nvarchar(4000),
	[3/26/22] nvarchar(4000),	[3/27/22] nvarchar(4000),
	[3/28/22] nvarchar(4000),	[3/29/22] nvarchar(4000),
	[3/30/22] nvarchar(4000),	[3/31/22] nvarchar(4000),
	[4/1/22] nvarchar(4000),	[4/2/22] nvarchar(4000),
	[4/3/22] nvarchar(4000),	[4/4/22] nvarchar(4000),
	[4/5/22] nvarchar(4000),	[4/6/22] nvarchar(4000),
	[4/7/22] nvarchar(4000),	[4/8/22] nvarchar(4000),
	[4/9/22] nvarchar(4000),	[4/10/22] nvarchar(4000)
	)
	WITH (
	LOCATION = 'time_series_covid19_confirmed_US.csv',
	DATA_SOURCE = [cssecovid19timeseries_anbenedadls_dfs_core_windows_net],
	FILE_FORMAT = [SynapseDelimitedTextFormat]
	)
GO


SELECT TOP 5 * FROM dbo.testCovid
where UID != 'UID'
GO

select	
	ROW_NUMBER() OVER(ORDER BY dateconfirmed ASC) AS Row#,
	combined_key, cast(dateconfirmed as date) AS [Confirmed Date], 
	confirmed,
	CAST( ISNULL ( LAG(confirmed, 1) OVER (ORDER BY dateconfirmed ASC) , 0 ) as int) as confirmedPrevDay,

	CAST (confirmed as int) - CAST( ISNULL ( LAG(confirmed, 1) OVER (ORDER BY dateconfirmed ASC) , 0 ) as int) as confirmedDiff
from
(
	select *
	from 
		(
			select replace (combined_key,'"','') as combined_key, 
				[3/31/21], [4/1/21], [4/2/21], [4/3/21],
				[4/4/21], [4/5/21], [4/6/21], [4/7/21], [4/8/21], [4/9/21], [4/10/21]
			from testCovid 
			where UID != 'UID'
		) p
	UNPIVOT 
		(confirmed for dateconfirmed in ([3/31/21], [4/1/21], [4/2/21], [4/3/21],
				[4/4/21], [4/5/21], [4/6/21], [4/7/21], [4/8/21], [4/9/21], [4/10/21])) as unpvt
) P
where combined_key like 'Miami-Dade'
